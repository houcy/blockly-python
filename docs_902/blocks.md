# blocks介绍文档

这个文档主要介绍blockly-div标签中定义的所有块样式。

## Blockly.Blocks模块介绍

此模块主要定义好所有的块，以供editor.js函数调用。其中每个块样式定义出来需要在`BlockPyEditor.CATEGORY_MAP`中进行引用，这中间的引用方式是通过定义每个block标签的type属性进行访问，这样刷新网页即可显示出来。每个块有自己的名字，这个名字就是每个block标签的type属性的名称，通过在Blockly.Blocks中添加相应的字典来实现属性的添加，即块的定义。

每个字典内部定义着这个块的静态结构以及动态结构。静态结构基本上就是这个块的初始样式以及点击按钮后加载的静态样式。动态样式则是指这些块可以存在一些按钮，比如range块点击左上角可以增添相应的输入框、break块可以检测块是否放在子函数中、数值运算模块有下拉框可以在一个块中进行+-*/的选择等等，这些块的动态逻辑都是由这个字典块中其他函数定义的。

## Blockly.Blocks模块主要函数介绍

所有函数定义在.../blockly/core/block.js中，需要引用即可，函数名命名比较规范，自带解释属性。

## Blockly.Python模块介绍

定义完了块样式，还需要进行block向Python的翻译，这个模块架构的样式和Blockly.Blocks模块大致相似，但是不同点在于模块中每个块翻译方法写成了函数的形式，需要将定义好的block标签以形式参数的形式传入，因为在翻译过程中需要获取块中选择的或者是以field形式输入的参数。然后回传一段组织好的代码用于翻译区的显示以及代码执行。

值得注意的是，如果这个块翻译的结果结尾没有换行符，即这不是一个独立的语句的时候，此时需要在返回的时候加上`[]`，同时在后面那个参数中说明这个算符的优先级，算符优先级在`.../blockly/generators/python.js`的65行到86行定义，加上`[]`保证是以一个数组的形式回传，这样保证后续将这一段语句放进其他语句的时候可以方便的访问参数优先级从而直接进行相应的特定操作比如加括号、加双引号等等。

模块内部主要是按照Python语法组织相应的语句，同时需要保证良好的格式，以及添加必要的子函数和import等等，这中间比较复杂的就是获取块中现有参数这一部分，但是通过传入的block参数都可以访问到。